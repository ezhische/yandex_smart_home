# Настройка режимов/функций
Для некоторых устройств в УДЯ предусмотрено управление режимами. Типичные примеры - охлаждение/нагрев/осушение для кондиционера,
низкая/средняя скорость вращения для вентилятора или режимы освещения у светильников.

[Список режимов](https://yandex.ru/dev/dialogs/smart-home/doc/concepts/mode-instance-modes.html) в УДЯ фиксированный,
поэтому их необходимо связывать со значениями атрибутов в Home Assistant. Для большинства устройств этот процесс (маппинг)
происходит **автоматически**, но в некоторых случаях его потребуется настроить вручную через параметр `modes` в `entity_config`.

Со стороны УДЯ нет жесткой привязки значений режимов к типам устройств. Другими словами, у режима "Скорость вентиляции"
(`fan_speed`) значения могут быть не только "низкое", "высокое", но и совсем от другого типа устройств, например "дичь" или "эспрессо".

Если маппинг не удался - управление функцией через УДЯ будет недоступно.

Если часть режимов не удалось связать, в [`Журнале сервера`](https://my.home-assistant.io/redirect/logs/) будут появляться ошибки `Unsupported mode "XXX"`.

Для их устранения задайте соответствия режимов УДЯ <--> HA используя пример ниже, 
или напишите в [чат](https://t.me/yandex_smart_home) в Telegram, и эта ошибка будет устранена в следующей версии.

!!! example "Пример"
    ```yaml
    yandex_smart_home:
      entity_config:
        light.led_strip:
          modes:
            scene:
              sunrise:
                - Wake up
              alarm:
                - Blink
              fantasy:
                - Огоньки
        climate.some_ac:
          modes:
            fan_speed:
              auto: ['auto']
              min: ['1','1.0']
              turbo: ['5','5.0']
              max: ['6','6.0']
            swing:
              auto: ['SWING']
              stationary: ['OFF']
    ```

* `scene`, `fan_speed`, `swing` - режим/функция со стороны УДЯ ([все функции](https://yandex.ru/dev/dialogs/smart-home/doc/concepts/mode-instance.html) + `scene` для светильников)
* `auto`, `stationary`, `alarm` - значение режима со стороны УДЯ ([возможные значения режимов](https://yandex.ru/dev/dialogs/smart-home/doc/concepts/mode-instance-modes.html), [возможные значения сцен](#scene))
* Списки значений (`Wake Up`, `Swing` и т.п.) - значения атрибута объекта в Home Assistant, которое соответствует значению режима в УДЯ.
  Задавать лучше строками в кавычках.

Ниже детальная информация по поддерживаемым режимам и их значениям.

### thermostat
Установка температурного режима работы климатической техники, например, в кондиционере.

* Поддерживаемые домены: `climate`
* Рекомендуемые значения режимов: `heat`, `cool`, `auto`, `dry`, `fan_only`
* Атрибут в Home Assistant: `hvac_modes`

### swing
Установка направления воздуха в климатической технике.

* Поддерживаемые домены: `climate`
* Рекомендуемые значение режимов: `vertical`, `horizontal`, `stationary`, `auto`
* Атрибут в Home Assistant: `swing_modes`

### program
Установка какой-либо программы работы.

* Поддерживаемые домены: `humidifier`, `fan`
* Рекомендуемые значения режимов: `normal`, `eco`, `min`, `turbo`, `medium`, `max`, `quiet`, `auto`, `high`
* Атрибут в Home Assistant:
    * `humidifier`: `available_modes`
    * `fan`: `preset_modes` (если поддерживается установка скорости в процентах)

### fan_speed
Установка режима работы скорости вентиляции, например, в кондиционере, вентиляторе или обогревателе.

* Поддерживаемые домены: `fan`, `climate`
* Рекомендуемые значения режимов: `auto`, `quiet`, `low`, `medium`, `high`, `turbo`
* Атрибут в Home Assistant:
    * `fan`: `preset_modes` (если не поддерживается установка скорости в процентах, сервис `fan.set_speed_percentage`)
    * `climate`: `fan_modes`

### fan_speed (скорость в процентах) { id=fan_speed-percentage }
Некоторые вентиляторы позволяют устанавливать скорость вентиляции в процентах, используя сервис `fan.set_speed_percentage`. 
Для таких вентиляторов компонент автоматически соотнесёт режим в УДЯ и скорость в процентах для функции "Скорость вентиляции".

Автоматическое соотношение можно переопределить путём указания числа с процентами в качестве режима со стороны HA:

!!! example "Пример"
    ```yaml
    yandex_smart_home:
      entity_config:
        fan.xiaomi:
          modes:
            fan_speed:
              low: ['10%']  # округляйте до целого
              normal: ['50%']
    ```

Рекомендуемые значения режимов: `eco`, `quiet`, `low`, `medium`, `normal`, `high`, `turbo`

### cleanup_mode
Установка режима уборки.

* Поддерживаемые домены: `vacuum`
* Рекомендуемые значения режимов: `auto`, `turbo`, `min`, `max`, `express`, `normal`, `quiet`
* Атрибут в Home Assistant: `fan_speed_list`

### input_source
Установка источника сигнала.

* Поддерживаемые домены: `media_player`
* Рекомендуемые значения режимов: `one`, `two`, `three`, `four`, `five`, `six`, `seven`, `eight`, `nine`, `ten`
* Атрибут в Home Assistant: `source_list`

### scene
Изменение режима работы светящихся элементов устройства в соответствии с предустановленными темами и сценариями освещения.

* Поддерживаемые домены: `light`
* Атрибут в Home Assistant: `effect_list`
* Значения режимов:

| Значение | Название в УДЯ |
|----------|----------------|
| alarm    | Тревога        |
| alice    | Алиса          |
| candle   | Свеча          |
| dinner   | Ужин           |
| fantasy  | Фантазия       |
| garland  | Гирлянда       |
| jungle   | Джунгли        |
| movie    | Кино           |
| neon     | Неон           |
| night    | Ночь           |
| ocean    | Океан          |
| party    | Вечеринка      |
| reading  | Чтение         |
| rest     | Отдых          |
| romance  | Романтика      |
| siren    | Сирена         |
| sunrise  | Рассвет        |
| sunset   | Закат          |
